<li class="item atoria-item-line-display {{item.type}} atoria-horizontal-bar atoria-expand-control"
 data-expand-id="{{item._id}}" data-drag="Item" data-item-id="{{item._id}}" >
    {{#if (eq item.type "kit")}}
        <input class="item-update float-input" data-name="system.quantity"
        type="text" inputmode="numeric" data-dtype="Number"  value="{{item.system.quantity}}"
        data-tooltip="{{localize item.systemFields.quantity.label}}" {{disabled (not @root.editable)}}/>
        {{#if item.system.has_usage_limit}}
            <input class="item-update float-input" data-name="system.usage_left"
            type="text" inputmode="numeric" data-dtype="Number"  value="{{item.system.usage_left}}"
            data-tooltip="{{localize item.systemFields.usage_left.label}}" {{disabled (not @root.editable)}} />
            <input class="float-input" type="text" inputmode="numeric" data-dtype="Number"  value="{{item.system.usage_max}}"
            data-tooltip="{{localize item.systemFields.usage_max.label}}" disabled />
        {{/if}}
    {{/if}}
    {{#if (eq item.type "armor")}}
        {{#unless compact}}
        <input class="item-update equip-toggle" data-name="system.is_worn"
        type="checkbox" data-dtype="Boolean" {{checked item.system.is_worn}}
         {{disabled (not @root.editable)}} />
        {{/unless}}
        {{#if (ne item.system.armor_type "without")}}
            <label class="armor-type">
            {{#if (eq item.system.armor_type "light")}}
            <img data-tooltip="{{localize (lookup item.systemFields.armor_type.choices item.system.armor_type)}}" src="systems/atoria/imgs/leather-armor.svg"/>
            {{/if}}
            {{#if (eq item.system.armor_type "medium")}}
                <img data-tooltip="{{localize (lookup item.systemFields.armor_type.choices item.system.armor_type)}}" src="systems/atoria/imgs/armor-vest.svg"/>
            {{/if}}
            {{#if (eq item.system.armor_type "heavy")}}
                <img data-tooltip="{{localize (lookup item.systemFields.armor_type.choices item.system.armor_type)}}" src="systems/atoria/imgs/lamellar.svg"/>
            {{/if}}
            {{!-- <label class="armor-type">{{localize (lookup item.systemFields.armor_type.choices item.system.armor_type)}} --}}
            </label>
            <hr/>
        {{/if}}
    {{/if}}
    {{#if (eq item.type "weapon")}}
        {{#unless compact}}
        <input class="item-update equip-toggle" data-name="system.is_worn"
        type="checkbox" data-dtype="Boolean" {{checked item.system.is_worn}}
        {{disabled (not @root.editable)}} />
        {{/unless}}
    {{/if}}
    <label class="name" data-action="expandSection" >{{item.name}}
        {{#if (and (eq @root.document.type "chest") item.flags.atoria.previous_owner_name)}}
        [{{item.flags.atoria.previous_owner_name}}]
        {{/if}}
    </label>
    {{#if @root.editable}}
        <a class="atoria-edit-button" data-action="editItem" data-item-id="{{item._id}}" data-tooltip="{{localize "ATORIA.Sheet.Item.Edit"}}">
            <i class="fas fa-edit"></i>
        </a>
        {{#if @root.isEditingMode}}
            <a class="atoria-delete-button" data-action="deleteItem" data-item-id="{{item._id}}" data-tooltip="{{localize "ATORIA.Sheet.Item.Delete"}}">
                <i class="fas fa-trash"></i>
            </a>
        {{/if}}
    {{/if}}
</li>
<li class="atoria-expand-direct-data flexcol" data-item-id="{{item._id}}">
    <label>{{localize item.systemFields.encumbrance.label}}: {{item.system.encumbrance}}</label>
    {{#if item.keywords_recap.list_data}}
    <label data-tooltip-class="atoria-tooltip" >{{localize item.systemFields.keywords.label}}:
        {{#each item.keywords_recap.list_data as |keyword_data idx|}}
        <span data-tooltip="{{keyword_data.description}}">{{keyword_data.label}}</span>,
        {{/each}}
    </label>
    {{/if}}
    {{#if item.keywords_recap.has_preserve}}
    <label>{{localize item.systemFields.keywords.fields.preserve.label}} {{item.system.keywords.preserve.max_amount}}
        {{localize (lookup item.systemFields.keywords.fields.preserve.fields.type.choices
            item.system.keywords.preserve.type)}}
        {{item.system.keywords.preserve.increment}}</label>
        {{#if (includes (arraytize "all" "mana") item.system.keywords.preserve.type)}}
        <label>{{localize item.systemFields.keywords.fields.preserve_mana.label}}:
            <input class="item-update float-input" data-name="system.keywords.preserve_mana"
            type="text" inputmode="numeric" data-dtype="Number"  value="{{item.system.keywords.preserve_mana}}"
            data-tooltip="{{localize item.systemFields.keywords.fields.preserve_mana.label}}" {{disabled (not @root.editable)}}/>
        </label>
        {{/if}}
        {{#if (includes (arraytize "all" "health") item.system.keywords.preserve.type)}}
        <label>{{localize item.systemFields.keywords.fields.preserve_health.label}}:
            <input class="item-update float-input" data-name="system.keywords.preserve_health"
            type="text" inputmode="numeric" data-dtype="Number"  value="{{item.system.keywords.preserve_health}}"
            data-tooltip="{{localize item.systemFields.keywords.fields.preserve_health.label}}" {{disabled (not @root.editable)}}/>
        </label>
        {{/if}}
        {{#if (includes (arraytize "all" "stamina") item.system.keywords.preserve.type)}}
        <label>{{localize item.systemFields.keywords.fields.preserve_stamina.label}}:
            <input class="item-update float-input" data-name="system.keywords.preserve_stamina"
            type="text" inputmode="numeric" data-dtype="Number"  value="{{item.system.keywords.preserve_stamina}}"
            data-tooltip="{{localize item.systemFields.keywords.fields.preserve_stamina.label}}" {{disabled (not @root.editable)}}/>
        </label>
        {{/if}}
        {{#if (includes (arraytize "all" "endurance") item.system.keywords.preserve.type)}}
        <label>{{localize item.systemFields.keywords.fields.preserve_endurance.label}}:
            <input class="item-update float-input" data-name="system.keywords.preserve_endurance"
            type="text" inputmode="numeric" data-dtype="Number"  value="{{item.system.keywords.preserve_endurance}}"
            data-tooltip="{{localize item.systemFields.keywords.fields.preserve_endurance.label}}" {{disabled (not @root.editable)}}/>
        </label>
        {{/if}}
        {{#if (includes (arraytize "all" "sanity") item.system.keywords.preserve.type)}}
        <label>{{localize item.systemFields.keywords.fields.preserve_sanity.label}}:
            <input class="item-update float-input" data-name="system.keywords.preserve_sanity"
            type="text" inputmode="numeric" data-dtype="Number"  value="{{item.system.keywords.preserve_sanity}}"
            data-tooltip="{{localize item.systemFields.keywords.fields.preserve_sanity.label}}" {{disabled (not @root.editable)}}/>
        </label>
        {{/if}}
    {{/if}}
    {{#if item.keywords_recap.has_reserve}}
    <label>{{localize item.systemFields.keywords.fields.reserve.label}}
        <input class="item-update float-input" data-name="system.keywords.reserve_current"
        type="text" inputmode="numeric" data-dtype="Number"  value="{{item.system.keywords.reserve_current}}"
        data-tooltip="{{localize item.systemFields.keywords.fields.reserve_current.label}}" {{disabled (not @root.editable)}}/>
        / {{item.system.keywords.reserve_max}}</label>
    {{/if}}
    {{#if (eq item.type "weapon")}}

        {{#if item.system.range}}
            <label><b>{{localize item.systemFields.range.label}}:</b> {{item.system.range}}</label>
        {{/if}}

        {{#if item.system.associated_skill}}
            {{>"atoria.v2.commons_partials.rollfield-display" rollfield=item.system.damage_roll systemFields=item.systemFields.damage_roll.fields
                data_path="system.focuser_damage_roll" hide_name=false}}
        {{/if}}

        {{#if item.system.is_focuser}}
            {{>"atoria.v2.commons_partials.rollfield-display" rollfield=item.system.focuser_damage_roll systemFields=item.systemFields.focuser_damage_roll.fields
                data_path="system.focuser_damage_roll" hide_name=false}}
        {{/if}}

    {{/if}}
    <div style="display: grid;">
        <textarea
            class="textarea-auto-resize"
            style="grid-area: 1 / 1 / 2/ 2;"
            rows="1"
            data-name="{{item._id}}_description" data-dtype="String"
            disabled>{{cleanLines item.system.description}}</textarea>
        <div
        class="textarea-auto-resize-sibling"
        aria-hidden="true"
        style="visibility: hidden; grid-area: 1 / 1 / 2 / 2;"
        >{{cleanLines item.system.description}}</div>
    </div>
</li>
